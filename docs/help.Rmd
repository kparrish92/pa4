---
title: "Programming Assignment 4"
subtitle: "⚔<br/>with xaringan"
author: "Kaylee Fernandez"
institute: "Rutgers University"
date: "March, 7, 2021"
output:
  xaringan::moon_reader:
    lib_dir: libs
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---
``` {r setup, include = FALSE, message = FALSE, warning = FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)
options(scipen = 999)
library(tidyverse)
library(knitr)
library(kableExtra)
library(ds4ling)
library(xaringan)
library(patchwork)
library(sjPlot)
library(lmtest)
library(lawstat)
library(ggfortify)
library(DataCombine)
library(gvlma)
```

```{r, load_data}
Raw_Fricatives = read.csv("../data_raw/fricatives.csv")
```
```{r, tidy_data}
Tidy_Fricatives = Raw_Fricatives %>%
  pivot_longer(c("s_cog", "s_skewness", "sh_cog", "sh_skewness"), names_to = "class", values_to = "hz") %>%
  separate("class", into = c("phoneme", "metric"), sep = "_") %>%
  pivot_wider(names_from = "metric", values_from = "hz")
```
```{r, clean_column_names}
Tidy_Fricatives <- Tidy_Fricatives %>%
  rename(., c("COG" = "cog"),
         c("Phoneme" = "phoneme"),
         c("Skewness" = "skewness"),
         c("Observation" = "obs"))
write_csv(Tidy_Fricatives, "../data_tidy/tidy fricatives.csv")
```
```{r, descriptive_stats}
Descriptive_Fricatives <- Tidy_Fricatives %>%
  group_by(Phoneme) %>%
  summarize(Mean_cog = mean(COG), SD_cog = sd(COG), Mean_skewness = mean(Skewness), SD_skewness = sd(Skewness))
```
#Descriptive Statistics
```{r, kable}
kable(Descriptive_Fricatives[1:5], caption = "Descriptive statistics for center of gravity and skewedness by phoneme (voiceless alveolar stop and voiceless prepalatal affricate)")
```
---
# COG as a Function of Phoneme
```{r, boxplot_cog}
Tidy_Fricatives %>%
  ggplot(aes(x = Phoneme, y = COG)) +
  geom_boxplot() +
  labs(x = "Phoneme", y = "Average center of gravity by trial", title = "Center of gravity by phoneme") + theme(plot.title = element_text(hjust = .5))
```
--- 
# Skewness as a Function of Phoneme
```{r, boxplot_skewedness}
Tidy_Fricatives %>%
  ggplot(aes(x = Phoneme, y = Skewness)) +
  geom_boxplot() +
  labs(x = "Phoneme", y = "Average skewness across trials", title = "Skewness by phoneme") + 
  theme(plot.title = element_text(hjust = 0.5))
```
---
```{r, original_model}
S_Model_Fricatives <- Tidy_Fricatives %>%
  filter(., Phoneme == "s")
```
# COG as a Function of Skewnesss, [s]
```{r, plot_model_initial}
S_Model_Fricatives %>%
  ggplot(aes(x = Skewness, y = COG)) +
  geom_point() +
  geom_smooth(method = lm) +
  labs(x = "Skewness", y = "Center of gravity", title = "Center of gravity as a function of skewness for /s/") +
    theme(plot.title = element_text(hjust = 0.5))
```
--- 
```{r, regression_intial}
S_Model_Regression <- lm(COG ~ Skewness, data = S_Model_Fricatives)
```
# Summary of Statistical Model
```{r, tab-model}
tab_model(S_Model_Regression)
```
---
# Assumptions of Initial Model 
``` {r, assumptions_diagnostic_initial}
ds4ling::diagnosis(S_Model_Regression)
gvlma::gvlma(S_Model_Regression)
mean(S_Model_Regression$residuals)
acf(S_Model_Regression$residuals)
plot(S_Model_Regression, 1)
plot(S_Model_Regression, 2)
plot(S_Model_Regression, 3)
plot(S_Model_Regression, 4)
bptest(S_Model_Regression)
lmtest::dwtest(S_Model_Regression)
acf(S_Model_Regression$residuals)
cor.test(Tidy_Fricatives$Skewness, S_Model_Regression$residuals)
shapiro.test(residuals(S_Model_Regression))
``` 
---
# Cook's Distance (Initial Model)
```{r, cooks_model}
Cooks_Fricatives = cooks.distance(S_Model_Regression)
```
```{r, plot_cooks_distance}
plot(Cooks_Fricatives)
```
---
# Summary of Revised Model
```{r, create_more_tidy_model}
More_Tidy_Fricatives = Tidy_Fricatives %>%
  filter(., Observation > 1)
More_Tidy_Fricatives = Tidy_Fricatives %>%
  filter(., Observation < 20)
More_Tidy_Fricatives = More_Tidy_Fricatives %>%
  filter(Phoneme == "s")
S_Modified_Regression <- lm(COG ~ Skewness, data = More_Tidy_Fricatives)
```
```{r, print_modified_model}
tab_model(S_Modified_Regression)
```
---
# Plot of Modified Model
```{r, plot_modified_model}
More_Tidy_Fricatives %>%
  ggplot(aes(x = Skewness, y = COG)) +
  geom_point() +
  geom_smooth(method = lm) +
  labs(x = "Skewness", y = "Center of gravity", title = "Center of Gravity as a Function of Skewness of /s/", caption = "Figure 5") +
  theme(plot.title = element_text(hjust =0.5))
```
---
# Diagnostics for Revised Model
```{r, diagnostics_revised_model}
ds4ling::diagnosis(S_Modified_Regression)
gvlma::gvlma(S_Modified_Regression)
mean(S_Modified_Regression$residuals)
acf(S_Modified_Regression$residuals)
plot(S_Modified_Regression, 1)
plot(S_Modified_Regression, 2)
plot(S_Modified_Regression, 3)
plot(S_Modified_Regression, 4)
bptest(S_Modified_Regression)
lmtest::dwtest(S_Modified_Regression)
acf(S_Modified_Regression$residuals)
cor.test(More_Tidy_Fricatives$Skewness, S_Modified_Regression$residuals)
shapiro.test(residuals(S_Modified_Regression))
```
---
# Cook's Distance (Revised Model)
```{r, cooks-revised}
Cooks_Modified_Fricatives = cooks.distance(S_Modified_Regression)
```
```{r, plot_cooks_revised}
plot(Cooks_Modified_Fricatives)
```
---
#Findings
The present analysis examined how a participant produced 10 trials of the voiceless alveolar fricative /s/ and 10 trials of the voiceless postalveolar fricative /ʃ/. For each trial, measures of the center of gravity and skewness in Hertz were reported. A bivariate regression was conducted to investigate the relationship of skewness in predicting center of gravity. An inspection of a Residuals vs. Fitted Plot revealed that the assumption of linearity was not met. The assumption that the mean of the residuals was equal to 0 was met. There was homoscedasticity, as assessed by visual inspection of a scatter plot as well as Breusch-Pagan Test (p > .05). The assumption of no autocorrelation of residuals was not met, as assessed by a Durbin-Watson statistic of 1.3028 (p < .05). The assumption that the predictor and residuals predictor and residuals are not correlated was not met (p < .05). Finally, as assessed by Shapiro-Wilk's test,  residuals were normally distributed (p > .05). Since an analysis of Cook's distance showed that trials XXXXXXXXX were not within the standard error of the other data points, these were removed. Following the removal of the outliers, 